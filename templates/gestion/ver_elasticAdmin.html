<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión Elasticsearch - BigData</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/temaindext.css') }}" rel="stylesheet">
</head>
<body>
    <div class="landing-page">
        <header>
          <div class="container">
            <a href="#" class="logo">Big <b>Data</b></a>
            <ul class="links">
              <li class="nav-item"><a class="nav-link" href="/gestion_proyecto" active><b>Gestionar Mongo Db</b></a></li>
              <li class="nav-item"><a class="nav-link" href="/elasticAdmin">Gestionar Elastic</a></li>
              <li class="nav-item"><a class="nav-link" href="/">Salir</a></li>
            </ul>
            </div>
        </header>
        <div class="container mt-4">
        <div class="row">
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <h3 class="card-title mb-0">Índice: {{ index_name }}</h3>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <a href="{{ url_for('elastic_agregar_documentos') }}" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Agregar Documentos
                            </a>
                            <a href="{{ url_for('elastic_listar_documentos') }}" class="btn btn-info">
                                <i class="fas fa-list"></i> Listar Documentos
                            </a>
                            <!-- NUEVO: botón reset -->
                            <button type="button" class="btn btn-danger" id="btn-reset-elastic">
                                <i class="fas fa-trash"></i> Resetear documentos del índice
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title mb-0">Información del Índice</h3>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <tbody>
                                    <tr>
                                        <th>Nombre del Índice</th>
                                        <td>{{ index_name }}</td>
                                    </tr>
                                    <tr>
                                        <th>Número de Documentos</th>
                                        <td>{{ doc_count }}</td>
                                    </tr>
                                    <tr>
                                        <th>Estado</th>
                                        <td><span class="badge bg-success">Conectado</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    </div>


  <div class="main"></div>
<div class="footer">
  <div class="bubbles">
    <!-- todo el bloque de burbujas original sin cambios -->
    <!-- ... -->
  </div>
  <div class="content">
    <div>
      <div><b>Creado Por: </b><a href="#">David Mateo Morales Romero</a></br>
        <b>Maestria en Analitica de Datos </b><a href="mailto:dmoralesr1@ucentral.edu.co"></br>
          <b>Correo: dmoralesr1@ucentral.edu.co</b></br>
      </div>
    </div>
    


    
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

    <!-- NUEVO: script para el botón reset -->
    <script>
    document.getElementById('btn-reset-elastic').addEventListener('click', function () {
        if (!confirm('¿Seguro que deseas eliminar TODOS los documentos del índice?')) {
            return;
        }

        fetch('/elastic-reset-documentos', {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(r => r.json())
        .then(data => {
            if (data.success) {
                alert('Se eliminaron ' + data.deleted + ' documentos.');
                location.reload();
            } else {
                alert('Error al resetear documentos: ' + (data.error || 'desconocido'));
            }
        })
        .catch(err => {
            alert('Error de red: ' + err);
        });
    });
    </script>
</body>
</html>
